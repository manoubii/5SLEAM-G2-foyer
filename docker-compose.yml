version: '3.8'

services:
  # MySQL Database Service
  mysql:
    image: mysql:8.0                 # MySQL version 8.0
    environment:
      MYSQL_DATABASE: saeb-tp-foyer   # Nom de la base de données
      MYSQL_ROOT_PASSWORD:            # Optionnel : spécifiez un mot de passe pour l'utilisateur root
    ports:
      - "3306:3306"                   # Expose MySQL port
    volumes:
      - mysql_data:/var/lib/mysql     # Persist MySQL data
    networks:
      - foyer-network                  # Custom network for communication

  # Spring Boot Application Service
  tp-foyer:
    image: saebmkaddem/tp-foyer:5.0.0  # Docker image name for Spring Boot app with your name
    depends_on:
      - mysql                          # Ensure MySQL starts before the app
    environment:
      SPRING_DATASOURCE_URL: jdbc:mysql://mysql:3306/saeb-tp-foyer?createDatabaseIfNotExist=true
      SPRING_DATASOURCE_USERNAME: root
      SPRING_DATASOURCE_PASSWORD:     # Laissez vide pour correspondre à la config MySQL ou définissez un mot de passe ici
    ports:
      - "8089:8089"                   # Expose the Spring Boot application port
    networks:
      - foyer-network

volumes:
  mysql_data:                         # Named volume for MySQL persistence

networks:
  foyer-network:                      # Custom network to connect both containers
